!function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n){!function(e,t,n,o){function s(e){for(;e&&"undefined"!=typeof e.originalEvent;)e=e.originalEvent;return e}function i(t,n){var i,a,r,c,l,p,u,v,h,d=t.type;if(t=e.Event(t),t.type=n,i=t.originalEvent,a=e.event.props,d.search(/^(mouse|click)/)>-1&&(a=I),i)for(u=a.length,c;u;)c=a[--u],t[c]=i[c];if(d.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==d.search(/^touch/)&&(r=s(i),d=r.touches,l=r.changedTouches,p=d&&d.length?d[0]:l&&l.length?l[0]:o))for(v=0,h=P.length;h>v;v++)c=P[v],t[c]=p[c];return t}function a(t){for(var n,o,s={};t;){n=e.data(t,M);for(o in n)n[o]&&(s[o]=s.hasVirtualBinding=!0);t=t.parentNode}return s}function r(t,n){for(var o;t;){if(o=e.data(t,M),o&&(!n||o[n]))return t;t=t.parentNode}return null}function c(){j=!1}function l(){j=!0}function p(){H=0,z.length=0,F=!1,l()}function u(){c()}function v(){h(),S=setTimeout(function(){S=0,p()},e.vmouse.resetTimerDuration)}function h(){S&&(clearTimeout(S),S=0)}function d(t,n,o){var s;return(o&&o[t]||!o&&r(n.target,t))&&(s=i(n,t),e(n.target).trigger(s)),s}function f(t){var n,o=e.data(t.target,X);F||H&&H===o||(n=d("v"+t.type,t),n&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation()))}function g(t){var n,o,i,r=s(t).touches;r&&1===r.length&&(n=t.target,o=a(n),o.hasVirtualBinding&&(H=N++,e.data(n,X,H),h(),u(),L=!1,i=s(t).touches[0],O=i.pageX,x=i.pageY,d("vmouseover",t,o),d("vmousedown",t,o)))}function m(e){j||(L||d("vmousecancel",e,a(e.target)),L=!0,v())}function w(t){if(!j){var n=s(t).touches[0],o=L,i=e.vmouse.moveDistanceThreshold,r=a(t.target);L=L||Math.abs(n.pageX-O)>i||Math.abs(n.pageY-x)>i,L&&!o&&d("vmousecancel",t,r),d("vmousemove",t,r),v()}}function b(e){if(!j){l();var t,n,o=a(e.target);d("vmouseup",e,o),L||(t=d("vclick",e,o),t&&t.isDefaultPrevented()&&(n=s(e).changedTouches[0],z.push({touchID:H,x:n.clientX,y:n.clientY}),F=!0)),d("vmouseout",e,o),L=!1,v()}}function T(t){var n,o=e.data(t,M);if(o)for(n in o)if(o[n])return!0;return!1}function y(){}function D(t){var n=t.substr(1);return{setup:function(){T(this)||e.data(this,M,{});var o=e.data(this,M);o[t]=!0,C[t]=(C[t]||0)+1,1===C[t]&&B.bind(n,f),e(this).bind(n,y),Q&&(C.touchstart=(C.touchstart||0)+1,1===C.touchstart&&B.bind("touchstart",g).bind("touchend",b).bind("touchmove",w).bind("scroll",m))},teardown:function(){--C[t],C[t]||B.unbind(n,f),Q&&(--C.touchstart,C.touchstart||B.unbind("touchstart",g).unbind("touchmove",w).unbind("touchend",b).unbind("scroll",m));var o=e(this),s=e.data(this,M);s&&(s[t]=!1),o.unbind(n,y),T(this)||o.removeData(M)}}}var $,E,M="virtualMouseBindings",X="virtualTouchID",Y="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),P="clientX clientY pageX pageY screenX screenY".split(" "),k=e.event.mouseHooks?e.event.mouseHooks.props:[],I=e.event.props.concat(k),C={},S=0,O=0,x=0,L=!1,z=[],F=!1,j=!1,Q="addEventListener"in n,B=e(n),N=1,H=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},E=0;E<Y.length;E++)e.event.special[Y[E]]=D(Y[E]);Q&&n.addEventListener("click",function(t){var n,o,s,i,a,r,c=z.length,l=t.target;if(c)for(n=t.clientX,o=t.clientY,$=e.vmouse.clickDistanceThreshold,s=l;s;){for(i=0;c>i;i++)if(a=z[i],r=0,s===l&&Math.abs(a.x-n)<$&&Math.abs(a.y-o)<$||e.data(s,X)===a.touchID)return t.preventDefault(),t.stopPropagation(),void 0;s=s.parentNode}},!0)}(e,t,n),function(e){e.mobile={}}(e),function(e){var t={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,t),e.extend(e.mobile.support,t)}(e),function(e,t,o){function s(t,n,s,i){var a=s.type;s.type=n,i?e.event.trigger(s,o,t):e.event.dispatch.call(t,s),s.type=a}var i=e(n),a=e.mobile.support.touch,r="touchmove scroll",c=a?"touchstart":"mousedown",l=a?"touchend":"mouseup",p=a?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){n=t,s(i,n?"scrollstart":"scrollstop",e)}var n,o,i=this,a=e(i);a.bind(r,function(s){e.event.special.scrollstart.enabled&&(n||t(s,!0),clearTimeout(o),o=setTimeout(function(){t(s,!1)},50))})},teardown:function(){e(this).unbind(r)}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),o=!1;n.bind("vmousedown",function(a){function r(){clearTimeout(p)}function c(){r(),n.unbind("vclick",l).unbind("vmouseup",r),i.unbind("vmousecancel",c)}function l(e){c(),o||u!==e.target?o&&e.preventDefault():s(t,"tap",e)}if(o=!1,a.which&&1!==a.which)return!1;var p,u=a.target;n.bind("vmouseup",r).bind("vclick",l),i.bind("vmousecancel",c),p=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(o=!0),s(t,"taphold",e.Event("taphold",{target:u}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),i.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var n=t.pageXOffset,o=t.pageYOffset,s=e.clientX,i=e.clientY;return 0===e.pageY&&Math.floor(i)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(s)>Math.floor(e.pageX)?(s-=n,i-=o):(i<e.pageY-o||s<e.pageX-n)&&(s=e.pageX-n,i=e.pageY-o),{x:s,y:i}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y]}},handleSwipe:function(t,n,o,i){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var a=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return s(o,"swipe",e.Event("swipe",{target:i,swipestart:t,swipestop:n}),!0),s(o,a,e.Event(a,{target:i,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,o=e(n),s={};t=e.data(this,"mobile-events"),t||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=s,s.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var o,a=e.event.special.swipe.start(t),r=t.target,c=!1;s.move=function(t){a&&(o=e.event.special.swipe.stop(t),c||(c=e.event.special.swipe.handleSwipe(a,o,n,r),c&&(e.event.special.swipe.eventInProgress=!1)),Math.abs(a.coords[0]-o.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},s.stop=function(){c=!0,e.event.special.swipe.eventInProgress=!1,i.off(p,s.move),s.move=null},i.on(p,s.move).one(l,s.stop)}},o.on(c,s.start)},teardown:function(){var t,n;t=e.data(this,"mobile-events"),t&&(n=t.swipe,delete t.swipe,t.length--,0===t.length&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(c,n.start),n.move&&i.off(p,n.move),n.stop&&i.off(l,n.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}})}(e,this)});